(()=>{"use strict";var e,t,n,r,a,o,c;!function(e){e.server="http://127.0.0.1:3000",e.garage="http://127.0.0.1:3000/garage",e.engine="http://127.0.0.1:3000/engine",e.winners="http://127.0.0.1:3000/winners"}(e||(e={})),function(e){e[e.cars=100]="cars"}(t||(t={})),function(e){e.start="started",e.stop="stopped"}(n||(n={})),function(e){e[e.startPos=0]="startPos",e[e.stopPos=200]="stopPos"}(r||(r={})),function(e){e[e.hard=3]="hard",e[e.medium=6]="medium",e[e.slow=11]="slow"}(a||(a={})),function(e){e.time="time",e.wins="win"}(o||(o={})),function(e){e[e.startpage=1]="startpage"}(c||(c={}));var i=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},l=function(e){return void 0===e&&(e=[]),e.length?"?".concat(e.map((function(e){return"".concat(e.key,"=").concat(e.value)})).join("&")):""},s=function(){return i(void 0,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(e.winners))];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},d=function(t){return i(void 0,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.winners).concat(t))];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}}))}))},f=function(e){return i(void 0,void 0,void 0,(function(){var t;return u(this,(function(n){return t=l([{key:"_page",value:e},{key:"_limit",value:10}]),[2,d(t)]}))}))},p=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},h=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},b=function(){var e=document.createElement("ul");return e.className="win__header win",e.innerHTML="".concat('\n    <li class="win__text">Number</li>\n    <li class="win__text">Car</li>\n    <li class="win__text">Name</li>\n    <li class="win__text" id="sort-win">Wins</li>\n    <li class="win__text" id="sort-time">Best time</li>\n'),e.addEventListener("click",(function(e){return p(void 0,void 0,void 0,(function(){return h(this,(function(t){if("sort-time"===e.target.id)n=o.time,i(void 0,void 0,void 0,(function(){var e;return u(this,(function(t){return e=l([{key:"_sort",value:n},{key:"_order",value:"ASC"}]),[2,d(e)]}))})),T();var n;return[2]}))}))})),e},v=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},m=function(e){return v(void 0,void 0,void 0,(function(){var t;return y(this,(function(n){var r;return void 0===(r=[{key:"_page",value:e},{key:"_limit",value:7}])&&(r=[]),t=r.length?"?".concat(r.map((function(e){return"".concat(e.key,"=").concat(e.value)})).join("&")):"",[2,w(t)]}))}))},w=function(t){return v(void 0,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.garage).concat(t))];case 1:return[2,n.sent().json()]}}))}))},g=function(){return v(void 0,void 0,void 0,(function(){var t,n,r;return y(this,(function(a){switch(a.label){case 0:return[4,fetch("".concat(e.garage))];case 1:return t=a.sent(),n=document.querySelector("#page-count-cars span"),[4,t.json()];case 2:return r=a.sent(),null!==n&&(n.innerText="".concat(r.length)),[2,r]}}))}))},_=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},x=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},k=function(e){return _(void 0,void 0,void 0,(function(){var t,n,r,a,o,c;return x(this,(function(i){switch(i.label){case 0:return t=e,[4,e];case 1:return n=i.sent(),[4,g()];case 2:for(r=i.sent(),(a=document.createElement("div")).className="win__car-all",a.id="list-win-car",o=function(e){var o=document.createElement("div");o.className="win__car";var c=document.createElement("div"),i=document.createElement("div"),u=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),d=n[e].id,f=t.findIndex((function(e){return e.id===d}));c.className="win__number",c.innerText="".concat(f+=1),i.className="win__car-svg",u.className="win__name",l.className="win__count",s.className="win__time",r.forEach((function(t){t.id===n[e].id&&(i.innerHTML='<svg class="car__icon-win" fill="'.concat(t.color,'" id="car-').concat(t.id,'">\n           <use xlink:href="../assets/img/car.svg#carview"></use>\n         </svg>`'),u.innerHTML="".concat(t.name),l.innerHTML="".concat(n[e].wins),s.innerHTML="".concat(n[e].time))})),o.appendChild(c),o.appendChild(i),o.appendChild(u),o.appendChild(l),o.appendChild(s),a.appendChild(o)},c=0;c<n.length;c++)o(c);return[2,a]}}))}))},S=function(){return _(void 0,void 0,void 0,(function(){var e,t;return x(this,(function(n){switch(n.label){case 0:return(e=document.createElement("div")).className="win__table win",e.append(((u=document.createElement("div")).className="win__count-car",u)),e.append((r=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),c=document.createElement("button"),i=document.createElement("button"),o.className="page__text",a.className="page__btns",c.className="page__btn btn btn__right",i.className="page__btn btn btn__left",c.id="page-r",c.innerText="❱",i.id="page-l",i.innerText="❰",r.className="win__count-page",o.innerHTML='Page <span id="count-win-page">1</span>',a.appendChild(i),a.appendChild(c),r.appendChild(o),r.appendChild(a),c.addEventListener("click",(function(){var e=o.lastChild,t=Number(e.innerText);t+=1,e.innerText="".concat(t),T()})),i.addEventListener("click",(function(){var e=o.lastChild,t=Number(e.innerText);t-=1,e.innerHTML="".concat(t),T()})),r)),e.append(b()),[4,f(1)];case 1:return t=n.sent(),k(t).then((function(t){e.appendChild(t)})),[2,e]}var r,a,o,c,i,u}))}))},T=function(){return _(void 0,void 0,void 0,(function(){var e,t,n,r,a,o,i,u;return x(this,(function(l){switch(l.label){case 0:return[4,s()];case 1:return e=l.sent(),(t=document.querySelector("#list-win-car")).innerHTML="",n=document.querySelector("#count-win-page"),r=document.querySelector("#page-r"),a=document.querySelector("#page-l"),o=Math.ceil(e.length/10),(i=Number(n.innerText))>=o?(r.setAttribute("disabled","disabled"),i=o,n.innerText="".concat(i)):r.removeAttribute("disabled"),i<=c.startpage?(a.setAttribute("disabled","disabled"),i=c.startpage,n.innerText="".concat(i)):a.removeAttribute("disabled"),[4,f(i)];case 2:return u=l.sent(),k(u).then((function(e){t.appendChild(e)})),[2]}}))}))},E=function(){return document.querySelector("#car-name__update")},C=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},N=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},A=function(){var t=0,n=E(),r=document.querySelector("#car-color__update"),a=n.value;document.querySelectorAll(".car").forEach((function(e){var n=e;n.classList.contains("choice")&&(t=Number(n.id))}));var o={name:"",color:"",id:0};o.name=a.slice(0,1).toUpperCase()+a.slice(1),o.color=r.value,o.id=t,0!==t?function(t,n){C(void 0,void 0,void 0,(function(){return N(this,(function(r){switch(r.label){case 0:return[4,fetch("".concat(e.garage,"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:return r.sent(),Q(),[2]}}))}))}(t,o):alert("AHAHA"),n.value=""},L=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},q=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},P=function(){var t=0;document.querySelectorAll(".car").forEach((function(e){var n=e;n.classList.contains("choice")&&(t=Number(n.id))})),0!==t?function(t){L(void 0,void 0,void 0,(function(){var n,r,a;return q(this,(function(o){switch(o.label){case 0:return[4,fetch("".concat(e.garage,"/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"}})];case 1:return o.sent(),[4,s()];case 2:for(n=o.sent(),r=0,a=n;r<a.length;r++)a[r].id===t&&(fetch("".concat(e.winners,"/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"}}),T());return Q(),[2]}}))}))}(t):alert("UPS"),E().value=""},M=function(){document.querySelectorAll(".btn").forEach((function(e){e.classList.contains("btn__race-stop")||e.classList.contains("btn__update-car")||e.classList.contains("btn__race-all--car")||e.removeAttribute("disabled")}))},H=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},G=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},j=function(t){return H(void 0,void 0,void 0,(function(){var n;return G(this,(function(r){switch(r.label){case 0:return[4,s()];case 1:return(n=r.sent()).forEach((function(n){if(n.id===t.id){var r=n.wins;n.time<t.time&&(t.time=n.time),t.wins=++r,function(t){H(void 0,void 0,void 0,(function(){return G(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.winners,"/").concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return n.sent(),[2]}}))}))}(t)}})),0===n.filter((function(e){return e.id===t.id})).length&&(a=t,H(void 0,void 0,void 0,(function(){return G(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(e.winners),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})];case 1:return t.sent(),[2]}}))}))),[2]}var a}))}))},O=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},F=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},R=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},U=[],D=[],I={},W=function(t){return O(void 0,void 0,void 0,(function(){var n;return F(this,(function(a){switch(a.label){case 0:return n=document.querySelector("#car-".concat(t)),[4,fetch("".concat(e.engine,"/?id=").concat(t,"&status=stopped"),{method:"PATCH"})];case 1:return 200===a.sent().status&&(cancelAnimationFrame(I[t]),n.style.transform="translateX(".concat(r.startPos,"px)")),[2]}}))}))};function J(t,n,a){return O(this,void 0,void 0,(function(){var o,c,i,u,l;return F(this,(function(s){return o=document.querySelector("#all-race"),c=(new Date).getTime(),i=document.querySelector("#car-".concat(n)),u=r.startPos,l=function(){if(u+=t/(100*a),i.style.transform="translateX(".concat(u,"px)"),u<t-r.stopPos)I[n]=requestAnimationFrame(l);else{!function(t){O(void 0,void 0,void 0,(function(){return F(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.engine,"/?id=").concat(t,"&status=stopped"),{method:"PATCH"})];case 1:return n.sent(),[2]}}))}))}(n),cancelAnimationFrame(I[n]);var s=(new Date).getTime();if(U.push(n),o.classList.contains("run__race"))!function(e,t){var n,r=document.querySelector("#car-".concat(t)),a=document.querySelector(".popup"),o=document.querySelector(".popup__text"),c=null===(n=r.parentElement)||void 0===n?void 0:n.title;o.innerText="".concat(c," ").concat(e," sec."),a.style.display="block",setTimeout((function(){a.style.display="none"}),3500);var i={id:t,time:Number(e),wins:1};j(i)}(((s-c)/1e3).toFixed(2),n),o.classList.remove("run__race")}},l(),[2]}))}))}var X=function(t,n){return O(void 0,void 0,void 0,(function(){var r,a,o,c,i,u;return F(this,(function(l){switch(l.label){case 0:return[4,fetch("".concat(e.engine,"/?id=").concat(t,"&status=").concat(n),{method:"PATCH"})];case 1:return 200!==(r=l.sent()).status?[3,3]:[4,r.json()];case 2:a=l.sent(),o=a.velocity,c=a.distance,i=Math.floor(c/o/1e3),u=document.querySelector(".racing__slider"),function(t,n,r){O(void 0,void 0,void 0,(function(){return F(this,(function(a){switch(a.label){case 0:return J(t,n,r),[4,fetch("".concat(e.engine,"/?id=").concat(n,"&status=drive"),{method:"PATCH"})];case 1:return 500===a.sent().status&&(cancelAnimationFrame(I[n]),D.push(n)),[2]}}))}))}(u.offsetWidth,t,i),l.label=3;case 3:return[2]}}))}))},z=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},B=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},Y=function(e,t,n){var r=document.querySelector("#update-car");console.log(r),e.forEach((function(e){return e.classList.remove("choice")})),e.forEach((function(e){t.id===e.id&&e.classList.add("choice")}));var a=t.querySelector(".car__name");E().value=a.innerText,document.querySelector("#car-color__update").value=n},K=function(e,t,r,a){e.addEventListener("click",(function(o){var c=document.querySelector("#update-car"),i=e.querySelector("#run"),u=e.querySelector("#stop");switch(o.target.id){case"btn-select":Y(r,t,a),c.removeAttribute("disabled");break;case"btn-delete":Y(r,t,a),P();break;case"run":i.setAttribute("disabled","disabled"),u.removeAttribute("disabled"),X(Number(t.id),n.start);break;case"stop":u.setAttribute("disabled","disabled"),i.removeAttribute("disabled"),W(Number(t.id))}})),t.removeEventListener("click",A)},V=function(e){return z(void 0,void 0,void 0,(function(){var t,n;return B(this,(function(r){return t=[],(n=document.createElement("div")).className="racing__slider",e.then((function(e){for(var r=0;r<e.length;r++){var a=document.createElement("div");a.className="racing";var o=document.createElement("div");o.innerHTML='\n        <div class="car__action">\n        <button type="button" class="btn btn__select" id="btn-select">select</button>\n        <button type="button" class="btn btn__delete" id="btn-delete">delete</button>\n        <div class="car__name">'.concat(e[r].name,'</div>\n       </div>\n         <svg class="car__icon" fill="').concat(e[r].color,'" id="car-').concat(e[r].id,'">\n           <use xlink:href="../assets/img/car.svg#carview"></use>\n         </svg>');var c=e[r].color;o.className="car",o.id="".concat(e[r].id),o.title="".concat(e[r].name),o.style.color="".concat(e[r].color),a.innerHTML="".concat('\n      <button type="button" class="btn btn__race-start" id="run">O</button>\n      <button type="button" class="btn btn__race-stop" id="stop" disabled="disabled">X</button>\n      ').concat('<div class="car__finish finish" id="finish">\n<svg class="finish__flag">\n  <use xlink:href="../assets/img/finish.svg#finish"></use>\n</svg>\n</div>'),a.appendChild(o),t.push(o),n.appendChild(a),K(a,o,t,c)}})),[2,n]}))}))},Q=function(){return z(void 0,void 0,void 0,(function(){var e,t,n,r,a,o,i,u,l;return B(this,(function(s){switch(s.label){case 0:return E().value="",e=document.querySelector(".main"),t=document.querySelector("#page-title span"),n=document.querySelector("#run-right"),r=document.querySelector("#run-left"),a=Number(t.innerText),[4,g()];case 1:return o=s.sent(),i=Math.ceil(o.length/7),a>=i?(console.log(i),console.log(a),n.setAttribute("disabled","disabled"),a=i,t.innerText="".concat(a)):n.removeAttribute("disabled"),a<=c.startpage?(r.setAttribute("disabled","disabled"),a=c.startpage,t.innerText="".concat(a)):r.removeAttribute("disabled"),e.innerHTML="",u=m(Number(a)),[4,V(u)];case 2:return l=s.sent(),e.appendChild(l),[2]}}))}))},Z=["Opel","Lada","Volvo","Tesla","Škoda","Subaru","Mazda","Ford","GMC","Chevrolet"],$=["A8","2110","Explorer","Focus","6 Sedan","Kombi","Atenza","Acadia","Canyon","Savana","Yukon","Granta","Largus","Niva","Octavia RS","Rapid","Yeti","Camaro","Cruze","Cobalt","Legacy","Outback","WRX"],ee="0123456789ABCDEF",te=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},ne=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},re=function(t){return te(void 0,void 0,void 0,(function(){return ne(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.garage),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return n.sent(),Q(),[2]}}))}))},ae=function(){return te(void 0,void 0,void 0,(function(){var e,t,n,r,a;return ne(this,(function(o){for(e=Z[Math.floor(Math.random()*Z.length)],t=$[Math.floor(Math.random()*$.length)],n="#",r=0;r<6;r++)n+=ee[Math.floor(Math.random()*ee.length)];return a={name:"".concat(e," ").concat(t),color:n},re(a),[2]}))}))},oe=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},ce=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},ie=function(){return oe(void 0,void 0,void 0,(function(){var e,r,a,o,c;return ce(this,(function(i){switch(i.label){case 0:return(e=document.createElement("div")).className="garage",r=function(){var e=document.createElement("div");return e.className="garage__forms",e.innerHTML="".concat('\n  <form class="form">\n    <input type="text" value="" placeholder="name car" id="car-name" name="name" class="form__name">\n    <input type="color" id="car-color" name="color" value="#e66465">\n    <div class="form__btns">\n    <button type="button" class="btn btn__create-car" id="one-car">Create</button>\n\n    </div>\n    <input type="text" value="" placeholder="name car" id="car-name__update" name="name"  class="form__name">\n    <input type="color" id="car-color__update" name="color" value="#e66465">\n    <div class="form__btns">\n    <button type="button" class="btn btn__update-car" id="update-car" disabled="disabled">Update</button>\n    </div>\n    <div class="form__btn-racing--cars">\n    <button type="button" class="btn btn__race-all--car" id="all-race">start racing</button>\n    <button type="button" class="btn btn__reset-all--car" id="all-reset">reset racing</button>\n    <button type="button" class="btn btn__create-all--car" id="create-cars">create cars</button>\n    </div>\n    <div class="page">\n    <div class="page__text"><h1 id="page-count-cars">Cars(<span></span>)</h1></div>\n    <div class="page__text"><h1 id="page-title">#PAGE <span>1</span></h1></div>\n    <div class="page__btns">\n    <button type="button" class="page__btn btn btn__left" id="run-left" disabled="disabled">❰</button>\n    <button type="button" class="page__btn btn btn__right" id="run-right">❱</button>\n    </div>\n    </div>\n</form>\n  '),e}(),[4,z(void 0,void 0,void 0,(function(){var e,t,n;return B(this,(function(r){switch(r.label){case 0:return(e=document.createElement("main")).className="main",t=m(1),[4,V(t)];case 1:return n=r.sent(),e.appendChild(n),g(),[2,e]}}))}))];case 1:return a=i.sent(),(u=document.createElement("div")).className="popup block",u.innerHTML="".concat('\n <h1 class="popup__title">WINNER</h1>\n <div class="popup__text">Lada</div>\n'),o=u,e.append(r),e.appendChild(a),e.appendChild(o),c=r.querySelector("#page-title span"),r.addEventListener("click",(function(e){var o=r.querySelector("#all-race"),i=[];a.querySelectorAll(".car").forEach((function(e){i.push(Number(e.id))}));var u,l,s=e.target,d=Number(c.innerText);switch(s.id){case"one-car":te(void 0,void 0,void 0,(function(){var e,t,n;return ne(this,(function(r){switch(r.label){case 0:return e=document.querySelector("#car-color"),0===(t=document.querySelector("#car-name")).value.length&&(t.value=Z[Math.floor(Math.random()*Z.length)]),n={name:t.value.slice(0,1).toUpperCase()+t.value.slice(1),color:e.value},[4,re(n)];case 1:return r.sent(),t.value="",[2]}}))}));break;case"create-cars":!function(){for(var e=0;e<t.cars;e++)ae()}();break;case"update-car":A(),s.setAttribute("disabled","disabled");break;case"delete-car":P();break;case"run-right":d+=1,c.innerText="".concat(d),Q();break;case"run-left":(d-=1)<1&&(d=1),c.innerText="".concat(d),Q();break;case"all-race":s.classList.add("run__race"),u=i,l=n.start,O(void 0,void 0,void 0,(function(){var e,t,n,r;return F(this,(function(a){for(D=[],U=[],e=0,t=u;e<t.length;e++)n=t[e],X(n,l);return r=setInterval((function(){var e=Array.from(new Set(R(R([],D,!0),U,!0)));u.length===e.length&&setTimeout((function(){M(),clearInterval(r)}),2e3)}),1500),[2]}))})),document.querySelectorAll(".btn").forEach((function(e){e.classList.contains("btn__win")||e.classList.contains("btn__garage")||e.classList.contains("btn__reset-all--car")||e.setAttribute("disabled","disabled")}));break;case"all-reset":!function(e){O(void 0,void 0,void 0,(function(){var t,n,r;return F(this,(function(a){for(t=0,n=e;t<n.length;t++)r=n[t],W(r),I={};return[2]}))}))}(i),M(),setTimeout((function(){o.removeAttribute("disabled")}),6500)}})),[2,e]}var u}))}))},ue=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(e){o(e)}}function i(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))},le=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};!function(){ue(this,void 0,void 0,(function(){var e,t,n;return le(this,(function(r){switch(r.label){case 0:return e=document.querySelector("body"),[4,ie()];case 1:return t=r.sent(),[4,_(void 0,void 0,void 0,(function(){return x(this,(function(e){return[2,S()]}))}))];case 2:return n=r.sent(),e.appendChild(t),e.appendChild(n),e.appendChild(function(){var e=document.createElement("button"),t=document.createElement("button"),n=document.createElement("div");n.className="navigate__btns",e.className="btn btn__garage",t.className="btn btn__win",e.innerHTML="GARAGE",t.innerHTML="WINNERS";var r=document.querySelector(".garage"),a=document.querySelector(".win");return t.addEventListener("click",(function(){var e=document.querySelector(".win__count-car");s().then((function(t){e.innerText="Cars ".concat(t.length)})),T(),r.style.display="none",a.style.display="block"})),e.addEventListener("click",(function(){r.style.display="block",a.style.display="none"})),n.appendChild(e),n.appendChild(t),n}()),[2,e]}}))}))}()})();