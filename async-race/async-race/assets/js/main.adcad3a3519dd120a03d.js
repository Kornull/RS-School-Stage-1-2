(()=>{"use strict";var e,t,n,r,a,c,o;!function(e){e.server="http://127.0.0.1:3000",e.garage="http://127.0.0.1:3000/garage",e.engine="http://127.0.0.1:3000/engine",e.winners="http://127.0.0.1:3000/winners"}(e||(e={})),function(e){e[e.cars=100]="cars"}(t||(t={})),function(e){e.start="started",e.stop="stopped"}(n||(n={})),function(e){e[e.startPos=0]="startPos",e[e.stopPos=200]="stopPos"}(r||(r={})),function(e){e[e.hard=3]="hard",e[e.medium=6]="medium",e[e.slow=11]="slow"}(a||(a={})),function(e){e.time="time",e.wins="wins",e.asc="ASC",e.desk="DESC"}(c||(c={})),function(e){e[e.startpage=1]="startpage"}(o||(o={}));var i=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},l=function(e){return e.length?"?".concat(e.map((function(e){return"".concat(e.key,"=").concat(e.value)})).join("&")):""},s=function(){return i(void 0,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(e.winners))];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},d=function(t){return i(void 0,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.winners).concat(t))];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}}))}))},f=function(e){return i(void 0,void 0,void 0,(function(){var t;return u(this,(function(n){return t=l([{key:"_page",value:e},{key:"_limit",value:10}]),[2,d(t)]}))}))},p=function(e,t,n){return i(void 0,void 0,void 0,(function(){var r;return u(this,(function(a){return r=l([{key:"_page",value:e},{key:"_sort",value:t},{key:"_order",value:n}]),[2,d(r)]}))}))},h=function(){return document.querySelector("#car-name__update")},b=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},v=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},m=function(){var t=0,n=h(),r=document.querySelector("#car-color__update"),a=n.value;document.querySelectorAll(".car").forEach((function(e){var n=e;n.classList.contains("choice")&&(t=Number(n.id))}));var c={name:"",color:"",id:0};c.name=a.slice(0,1).toUpperCase()+a.slice(1),c.color=r.value,c.id=t,0!==t?function(t,n){b(void 0,void 0,void 0,(function(){return v(this,(function(r){switch(r.label){case 0:return[4,fetch("".concat(e.garage,"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:return r.sent(),K(),[2]}}))}))}(t,c):alert("AHAHA"),n.value=""},y=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},w=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},_=function(e){return y(void 0,void 0,void 0,(function(){var t;return w(this,(function(n){var r;return void 0===(r=[{key:"_page",value:e},{key:"_limit",value:7}])&&(r=[]),t=r.length?"?".concat(r.map((function(e){return"".concat(e.key,"=").concat(e.value)})).join("&")):"",[2,g(t)]}))}))},g=function(t){return y(void 0,void 0,void 0,(function(){return w(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.garage).concat(t))];case 1:return[2,n.sent().json()]}}))}))},x=function(){return y(void 0,void 0,void 0,(function(){var t,n,r;return w(this,(function(a){switch(a.label){case 0:return[4,fetch("".concat(e.garage))];case 1:return t=a.sent(),n=document.querySelector("#page-count-cars span"),[4,t.json()];case 2:return r=a.sent(),null!==n&&(n.innerText="".concat(r.length)),[2,r]}}))}))},k=0,S=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},E=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},T=function(e){return S(void 0,void 0,void 0,(function(){var t,n,r,a,c,o;return E(this,(function(i){switch(i.label){case 0:return[4,s()];case 1:return t=i.sent(),n=e,[4,x()];case 2:for(r=i.sent(),(a=document.createElement("div")).className="win__car-all",a.id="list-win-car",c=function(e){var c=document.createElement("div");c.className="win__car";var o=document.createElement("div"),i=document.createElement("div"),u=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),d=n[e].id,f=t.findIndex((function(e){return e.id===d}));o.className="win__number",o.innerText="".concat(f+=1),i.className="win__car-svg",u.className="win__name",l.className="win__count",s.className="win__time",r.forEach((function(t){t.id===n[e].id&&(i.innerHTML='<svg class="car__icon-win" fill="'.concat(t.color,'" id="car-').concat(t.id,'">\n           <use xlink:href="./assets/img/car.svg#carview"></use>\n         </svg>`'),u.innerHTML="".concat(t.name),l.innerHTML="".concat(n[e].wins),s.innerHTML="".concat(n[e].time))})),c.appendChild(o),c.appendChild(i),c.appendChild(u),c.appendChild(l),c.appendChild(s),a.appendChild(c)},o=0;o<n.length;o++)c(o);return[2,a]}}))}))},C=function(){return S(void 0,void 0,void 0,(function(){var e,t,n;return E(this,(function(r){switch(r.label){case 0:return(e=document.createElement("div")).className="win__table win",e.append(((d=document.createElement("div")).className="win__count-car",d)),e.append((o=document.createElement("div"),i=document.createElement("div"),u=document.createElement("div"),l=document.createElement("button"),s=document.createElement("button"),u.className="page__text--win",i.className="page__btns",l.className="page__btn btn btn__right",s.className="page__btn btn btn__left",l.id="page-r",l.innerText="❱",s.id="page-l",s.innerText="❰",o.className="win__count-page",u.innerHTML='Page <span id="count-win-page">1</span>',i.appendChild(s),i.appendChild(l),o.appendChild(u),o.appendChild(i),l.addEventListener("click",(function(){var e=u.lastChild,t=Number(e.innerText);t+=1,e.innerText="".concat(t),L()})),s.addEventListener("click",(function(){var e=u.lastChild,t=Number(e.innerText);t-=1,e.innerHTML="".concat(t),L()})),o)),e.append(((a=document.createElement("ul")).className="win__header win",a.innerHTML="".concat('\n    <li class="win__text">Number</li>\n    <li class="win__text">Car</li>\n    <li class="win__text">Name</li>\n    <li class="win__text" id="sort-win">Wins</li>\n    <li class="win__text" id="sort-time">Best time</li>\n'),a.addEventListener("click",(function(e){switch(++k,e.target.id){case"sort-time":N(c.time,k%2==0?c.asc:c.desk);break;case"sort-win":N(c.wins,k%2==0?c.asc:c.desk)}})),11===k&&(k=1),a)),t=function(){var e=document.createElement("div");return e.className="win__list-cars",e.id="win-list-all-car",e}(),[4,f(1)];case 1:return n=r.sent(),T(n).then((function(e){t.appendChild(e)})),e.appendChild(t),[2,e]}var a,o,i,u,l,s,d}))}))},N=function(e,t){return S(void 0,void 0,void 0,(function(){var n,r,a,c;return E(this,(function(o){switch(o.label){case 0:return n=document.querySelector("#count-win-page"),r=Number(n.innerText),(a=document.querySelector("#list-win-car")).innerHTML="",c=T,[4,p(r,e,t)];case 1:return c.apply(void 0,[o.sent()]).then((function(e){a.appendChild(e)})),[2]}}))}))},L=function(){return S(void 0,void 0,void 0,(function(){var e,t,n,r,a,c,i,u;return E(this,(function(l){switch(l.label){case 0:return[4,s()];case 1:return e=l.sent(),(t=document.querySelector("#win-list-all-car")).innerHTML="",n=document.querySelector("#count-win-page"),r=document.querySelector("#page-r"),a=document.querySelector("#page-l"),c=Math.ceil(e.length/10),(i=Number(n.innerText))>=c?(r.setAttribute("disabled","disabled"),i=c,n.innerText="".concat(i)):r.removeAttribute("disabled"),i<=o.startpage?(a.setAttribute("disabled","disabled"),i=o.startpage,n.innerText="".concat(i)):a.removeAttribute("disabled"),u=T,[4,f(i)];case 2:return u.apply(void 0,[l.sent()]).then((function(e){t.appendChild(e)})),[2]}}))}))},A=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},q=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},M=function(){var t=0;document.querySelectorAll(".car").forEach((function(e){var n=e;n.classList.contains("choice")&&(t=Number(n.id))})),0!==t?function(t){A(void 0,void 0,void 0,(function(){var n,r,a;return q(this,(function(c){switch(c.label){case 0:return[4,fetch("".concat(e.garage,"/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"}})];case 1:return c.sent(),[4,s()];case 2:for(n=c.sent(),r=0,a=n;r<a.length;r++)a[r].id===t&&(fetch("".concat(e.winners,"/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"}}),L());return K(),[2]}}))}))}(t):alert("UPS"),h().value=""},P=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},H=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},G=function(t){return P(void 0,void 0,void 0,(function(){var n;return H(this,(function(r){switch(r.label){case 0:return[4,s()];case 1:return(n=r.sent()).forEach((function(n){if(n.id===t.id){var r=n.wins;n.time<t.time&&(t.time=n.time),t.wins=++r,function(t){P(void 0,void 0,void 0,(function(){return H(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.winners,"/").concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return n.sent(),[2]}}))}))}(t)}})),0===n.filter((function(e){return e.id===t.id})).length&&(a=t,P(void 0,void 0,void 0,(function(){return H(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(e.winners),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})];case 1:return t.sent(),[2]}}))}))),[2]}var a}))}))},j=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},O=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},F=[],D=[],R={},U=function(t){return j(void 0,void 0,void 0,(function(){var n;return O(this,(function(a){switch(a.label){case 0:return n=document.querySelector("#car-".concat(t)),[4,fetch("".concat(e.engine,"/?id=").concat(t,"&status=stopped"),{method:"PATCH"})];case 1:return 200===a.sent().status&&(cancelAnimationFrame(R[t]),n.style.transform="translateX(".concat(r.startPos,"px)")),[2]}}))}))};function W(t,n,a){return j(this,void 0,void 0,(function(){var c,o,i,u,l;return O(this,(function(s){return c=document.querySelector("#all-race"),o=(new Date).getTime(),i=document.querySelector("#car-".concat(n)),u=performance.now(),l=function(s){u||(u=s);var d=(s-u)/a;if(i.style.transform="translateX(".concat(Math.min(d),"px)"),d<t-r.stopPos)R[n]=requestAnimationFrame(l);else{var f=(new Date).getTime();if(cancelAnimationFrame(R[n]),function(t){j(void 0,void 0,void 0,(function(){return O(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.engine,"/?id=").concat(t,"&status=stopped"),{method:"PATCH"})];case 1:return n.sent(),[2]}}))}))}(n),F.push(n),c.classList.contains("run__race")&&!c.classList.contains("close"))!function(e,t){var n,r=document.querySelector("#car-".concat(t)),a=document.querySelector(".popup"),c=document.querySelector(".popup__text"),o=null===(n=r.parentElement)||void 0===n?void 0:n.title;c.innerText="".concat(o," ").concat(e," sec."),a.style.display="block",setTimeout((function(){a.style.display="none"}),3500);var i={id:t,time:Number(e),wins:1};G(i),L()}(((f-o)/1e3).toFixed(2),n),c.classList.remove("run__race")}},l(1),[2]}))}))}var J=function(t,n){return j(void 0,void 0,void 0,(function(){var r,a,c,o,i,u;return O(this,(function(l){switch(l.label){case 0:return[4,fetch("".concat(e.engine,"/?id=").concat(t,"&status=").concat(n),{method:"PATCH"})];case 1:return 200!==(r=l.sent()).status?[3,3]:[4,r.json()];case 2:a=l.sent(),c=a.velocity,o=a.distance,i=Math.floor(o/c/1e3),u=document.querySelector(".racing__slider"),function(t,n,r){j(void 0,void 0,void 0,(function(){return O(this,(function(a){switch(a.label){case 0:return W(t,n,r),[4,fetch("".concat(e.engine,"/?id=").concat(n,"&status=drive"),{method:"PATCH"})];case 1:return 500===a.sent().status&&(cancelAnimationFrame(R[n]),D.push(n)),[2]}}))}))}(u.offsetWidth,t,i),l.label=3;case 3:return[2]}}))}))},X=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},z=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},I=function(e,t,n){document.querySelector("#update-car");e.forEach((function(e){return e.classList.remove("choice")})),e.forEach((function(e){t.id===e.id&&e.classList.add("choice")}));var r=t.querySelector(".car__name");h().value=r.innerText,document.querySelector("#car-color__update").value=n},B=function(e,t,r,a){e.addEventListener("click",(function(c){var o,i=document.querySelector("#update-car"),u=e.querySelector("#run"),l=e.querySelector("#stop");switch(c.target.id){case"btn-select":I(r,t,a),i.removeAttribute("disabled");break;case"btn-delete":I(r,t,a),M();break;case"run":u.setAttribute("disabled","disabled"),l.removeAttribute("disabled"),null==(o=document.querySelector("#all-race"))||o.classList.add("close"),null==o||o.setAttribute("disabled","disabled"),J(Number(t.id),n.start);break;case"stop":l.setAttribute("disabled","disabled"),u.removeAttribute("disabled"),U(Number(t.id))}})),t.removeEventListener("click",m)},Y=function(e){return X(void 0,void 0,void 0,(function(){var t,n;return z(this,(function(r){return t=[],(n=document.createElement("div")).className="racing__slider",e.then((function(e){for(var r=0;r<e.length;r++){var a=document.createElement("div");a.className="racing";var c=document.createElement("div");c.innerHTML='\n        <div class="car__action">\n        <button type="button" class="btn btn__select" id="btn-select">select</button>\n        <button type="button" class="btn btn__delete" id="btn-delete">delete</button>\n        <div class="car__name">'.concat(e[r].name,'</div>\n       </div>\n         <svg class="car__icon" fill="').concat(e[r].color,'" id="car-').concat(e[r].id,'">\n           <use xlink:href="./assets/img/car.svg#carview"></use>\n         </svg>');var o=e[r].color;c.className="car",c.id="".concat(e[r].id),c.title="".concat(e[r].name),c.style.color="".concat(e[r].color),a.innerHTML="".concat('\n      <button type="button" class="btn btn__race-start" id="run">O</button>\n      <button type="button" class="btn btn__race-stop" id="stop" disabled="disabled">X</button>\n      ').concat('<div class="car__finish finish" id="finish">\n<svg class="finish__flag">\n  <use xlink:href="./assets/img/finish.svg#finish"></use>\n</svg>\n</div>'),a.appendChild(c),t.push(c),n.appendChild(a),B(a,c,t,o)}})),[2,n]}))}))},K=function(){return X(void 0,void 0,void 0,(function(){var e,t,n,r,a,c,i,u,l;return z(this,(function(s){switch(s.label){case 0:return h().value="",e=document.querySelector(".main"),t=document.querySelector("#page-title span"),n=document.querySelector("#run-right"),r=document.querySelector("#run-left"),a=Number(t.innerText),[4,x()];case 1:return c=s.sent(),i=Math.ceil(c.length/7),a>=i?(n.setAttribute("disabled","disabled"),a=i,t.innerText="".concat(a)):n.removeAttribute("disabled"),a<=o.startpage?(r.setAttribute("disabled","disabled"),a=o.startpage,t.innerText="".concat(a)):r.removeAttribute("disabled"),e.innerHTML="",u=_(Number(a)),[4,Y(u)];case 2:return l=s.sent(),e.appendChild(l),[2]}}))}))},V=["Opel","Lada","Volvo","Tesla","Škoda","Subaru","Mazda","Ford","GMC","Chevrolet"],Q=["A8","2110","Explorer","Focus","6 Sedan","Kombi","Atenza","Acadia","Canyon","Savana","Yukon","Granta","Largus","Niva","Octavia RS","Rapid","Yeti","Camaro","Cruze","Cobalt","Legacy","Outback","WRX"],Z="0123456789ABCDEF",$=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},ee=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},te=function(t){return $(void 0,void 0,void 0,(function(){return ee(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(e.garage),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return n.sent(),K(),[2]}}))}))},ne=function(){return $(void 0,void 0,void 0,(function(){var e,t,n,r,a;return ee(this,(function(c){for(e=V[Math.floor(Math.random()*V.length)],t=Q[Math.floor(Math.random()*Q.length)],n="#",r=0;r<6;r++)n+=Z[Math.floor(Math.random()*Z.length)];return a={name:"".concat(e," ").concat(t),color:n},te(a),[2]}))}))},re=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},ae=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},ce=function(){return re(void 0,void 0,void 0,(function(){var e,r,a,c,o;return ae(this,(function(i){switch(i.label){case 0:return(e=document.createElement("div")).className="garage",r=function(){var e=document.createElement("div");return e.className="garage__forms",e.innerHTML="".concat('\n  <form class="form">\n    <input type="text" value="" placeholder="name car" id="car-name" name="name" class="form__name">\n    <input type="color" id="car-color" name="color" value="#e66465">\n    <div class="form__btns">\n    <button type="button" class="btn btn__create-car" id="one-car">Create</button>\n\n    </div>\n    <input type="text" value="" placeholder="name car" id="car-name__update" name="name"  class="form__name">\n    <input type="color" id="car-color__update" name="color" value="#e66465">\n    <div class="form__btns">\n    <button type="button" class="btn btn__update-car" id="update-car" disabled="disabled">Update</button>\n    </div>\n    <div class="form__btn-racing--cars">\n    <button type="button" class="btn btn__race-all--car" id="all-race">start racing</button>\n    <button type="button" class="btn btn__reset-all--car" id="all-reset">reset racing</button>\n    <button type="button" class="btn btn__create-all--car" id="create-cars">create cars</button>\n    </div>\n    <div class="page">\n    <div class="page__text"><h1 id="page-count-cars">Cars(<span></span>)</h1></div>\n    <div class="page__text"><h1 id="page-title">#PAGE <span>1</span></h1></div>\n    <div class="page__btns">\n    <button type="button" class="page__btn btn btn__left" id="run-left" disabled="disabled">❰</button>\n    <button type="button" class="page__btn btn btn__right" id="run-right">❱</button>\n    </div>\n    </div>\n</form>\n  '),e}(),[4,X(void 0,void 0,void 0,(function(){var e,t,n;return z(this,(function(r){switch(r.label){case 0:return(e=document.createElement("main")).className="main",t=_(1),[4,Y(t)];case 1:return n=r.sent(),e.appendChild(n),x(),[2,e]}}))}))];case 1:return a=i.sent(),(u=document.createElement("div")).className="popup block",u.innerHTML="".concat('\n <h1 class="popup__title">WINNER</h1>\n <div class="popup__text">Lada</div>\n'),c=u,e.append(r),e.appendChild(a),e.appendChild(c),o=r.querySelector("#page-title span"),r.addEventListener("click",(function(e){var c=r.querySelector("#all-race"),i=[];a.querySelectorAll(".car").forEach((function(e){i.push(Number(e.id))}));var u,l,s=e.target,d=Number(o.innerText);switch(s.id){case"one-car":$(void 0,void 0,void 0,(function(){var e,t,n;return ee(this,(function(r){switch(r.label){case 0:return e=document.querySelector("#car-color"),0===(t=document.querySelector("#car-name")).value.length&&(t.value=V[Math.floor(Math.random()*V.length)]),n={name:t.value.slice(0,1).toUpperCase()+t.value.slice(1),color:e.value},[4,te(n)];case 1:return r.sent(),t.value="",[2]}}))}));break;case"create-cars":!function(){for(var e=0;e<t.cars;e++)ne()}();break;case"update-car":m(),s.setAttribute("disabled","disabled"),L();break;case"delete-car":M();break;case"run-right":d+=1,o.innerText="".concat(d),K();break;case"run-left":(d-=1)<1&&(d=1),o.innerText="".concat(d),K();break;case"all-race":s.classList.add("run__race"),u=i,l=n.start,j(void 0,void 0,void 0,(function(){var e,t,n;return O(this,(function(r){for(D=[],F=[],e=0,t=u;e<t.length;e++)n=t[e],J(n,l);return[2]}))})),document.querySelectorAll(".btn").forEach((function(e){e.classList.contains("btn__win")||e.classList.contains("btn__garage")||e.classList.contains("btn__reset-all--car")||e.setAttribute("disabled","disabled")}));break;case"all-reset":!function(e){j(void 0,void 0,void 0,(function(){var t,n,r;return O(this,(function(a){for(t=0,n=e;t<n.length;t++)r=n[t],U(r),R={};return[2]}))}))}(i),document.querySelectorAll(".btn").forEach((function(e){e.classList.contains("btn__race-stop")||e.classList.contains("btn__update-car")||e.classList.contains("btn__race-all--car")||(e.removeAttribute("disabled"),e.classList.contains("close")&&e.classList.remove("close")),e.classList.contains("btn__race-stop")&&e.setAttribute("disabled","disabled")})),setTimeout((function(){c.removeAttribute("disabled")}),3e3)}})),[2,e]}var u}))}))},oe=function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(e){c(e)}}function i(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},ie=function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}};!function(){oe(this,void 0,void 0,(function(){var e,t,n;return ie(this,(function(r){switch(r.label){case 0:return e=document.querySelector("body"),[4,ce()];case 1:return t=r.sent(),[4,S(void 0,void 0,void 0,(function(){return E(this,(function(e){return[2,C()]}))}))];case 2:return n=r.sent(),e.appendChild(t),e.appendChild(n),e.appendChild(function(){var e=document.createElement("button"),t=document.createElement("button"),n=document.createElement("div");n.className="navigate__btns",e.className="btn btn__garage",t.className="btn btn__win",e.innerHTML="GARAGE",t.innerHTML="WINNERS";var r=document.querySelector(".garage"),a=document.querySelector(".win");return t.addEventListener("click",(function(){var e=document.querySelector(".win__count-car");s().then((function(t){e.innerText="Cars ".concat(t.length)})),r.style.display="none",a.style.display="block"})),e.addEventListener("click",(function(){r.style.display="block",a.style.display="none"})),n.appendChild(e),n.appendChild(t),n}()),[2,e]}}))}))}()})();